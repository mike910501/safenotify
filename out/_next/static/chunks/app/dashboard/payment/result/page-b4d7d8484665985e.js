(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{54381:function(e,r,t){Promise.resolve().then(t.bind(t,60688))},60688:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return y}});var a=t(57437),s=t(2265),n=t(99376),o=t(8530),l=t(41671),c=t(99388),i=t(76865),d=t(91723),u=t(82431),m=t(76858),h=t(88226),x=t(56426),g=t(66070),f=t(76362);function p(){let e;let{user:r,checkAuth:t}=(0,f.a)(),p=(0,n.useRouter)(),y=(0,n.useSearchParams)().get("reference"),[b,j]=(0,s.useState)(null),[N,v]=(0,s.useState)(null),[w,k]=(0,s.useState)(!0),[E,C]=(0,s.useState)(!1),[P,S]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!y){p.push("/dashboard");return}D();let e=setInterval(()=>{b&&["PENDING","IN_PROGRESS"].includes(b.status)&&D(!1)},5e3);return()=>clearInterval(e)},[y]);let D=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e&&k(!0),e||C(!0);try{let e=localStorage.getItem("token"),a=await fetch("".concat(o.T,"/api/payments/transaction-status/").concat(y),{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();s.success&&(j(s.payment),v(s.transaction),S(new Date),"APPROVED"===s.payment.status&&(null==r?void 0:r.planType)!==s.payment.planType&&await t(),console.log("Payment status response:",{status:s.payment.status,hasTransaction:!!s.transaction,note:s.note,wompiError:s.wompiError}))}catch(e){console.error("Error checking payment status:",e)}finally{k(!1),C(!1)}},I=e=>new Date(e).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(w)return(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 mx-auto"}),(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})});if(!b)return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto text-center space-y-6",children:[(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),(0,a.jsx)("h1",{className:"text-xl font-semibold text-red-900 mb-2",children:"Pago No Encontrado"}),(0,a.jsx)("p",{className:"text-red-700",children:"No pudimos encontrar informaci\xf3n sobre este pago."})]}),(0,a.jsx)(x.z,{onClick:()=>p.push("/dashboard"),children:"Ir al Dashboard"})]});let Z=(e=>{switch(e){case"APPROVED":return{icon:l.Z,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",title:"\xa1Pago Exitoso!",message:"Tu plan ha sido actualizado correctamente."};case"DECLINED":return{icon:c.Z,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",title:"Pago Rechazado",message:"El pago fue rechazado. Por favor intenta con otro m\xe9todo de pago."};case"VOIDED":return{icon:c.Z,color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200",title:"Pago Anulado",message:"El pago fue anulado."};case"ERROR":return{icon:i.Z,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",title:"Error en el Pago",message:"Ocurri\xf3 un error procesando el pago. Por favor contacta soporte."};default:return{icon:d.Z,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",title:"Procesando Pago",message:"Tu pago est\xe1 siendo procesado. Esto puede tomar unos minutos."}}})(b.status),R=Z.icon;return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsx)(g.Zb,{className:"".concat(Z.bgColor," ").concat(Z.borderColor," border"),padding:"lg",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(R,{className:"w-16 h-16 ".concat(Z.color," mx-auto")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:Z.title}),(0,a.jsx)("p",{className:"text-gray-700",children:Z.message})]}),"PENDING"===b.status&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-3",children:[(0,a.jsx)(x.z,{variant:"outline",size:"sm",onClick:()=>D(!1),disabled:E,className:"hover:bg-blue-50 border-blue-300",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-1 animate-spin"}),"Consultando Wompi..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),"Verificar Estado Ahora"]})}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[(0,a.jsx)("p",{children:"\uD83D\uDCA1 Este bot\xf3n consulta directamente el estado en Wompi"}),(0,a.jsx)("p",{children:"Tambi\xe9n se verifica autom\xe1ticamente cada 5 segundos"}),P&&(0,a.jsxs)("p",{className:"text-green-600",children:["âœ“ \xdaltima verificaci\xf3n: ",P.toLocaleTimeString("es-CO")]})]})]})]})}),(0,a.jsxs)(g.Zb,{className:"bg-white",padding:"lg",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Detalles del Pago"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Referencia"}),(0,a.jsx)("span",{className:"font-mono text-sm text-gray-900",children:b.reference})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Plan"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:(e=>{switch(e){case"basic":return"Plan B\xe1sico";case"pro":return"Plan Pro";case"enterprise":return"Plan Enterprise";default:return e}})(b.planType)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Monto"}),(0,a.jsx)("span",{className:"font-bold text-gray-900",children:(e=b.amount,new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e))})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Estado"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-sm font-medium ".concat("APPROVED"===b.status?"bg-green-100 text-green-800":"DECLINED"===b.status?"bg-red-100 text-red-800":"PENDING"===b.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:b.status})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Fecha de creaci\xf3n"}),(0,a.jsx)("span",{className:"text-gray-900",children:I(b.createdAt)})]}),b.processedAt&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Fecha de procesamiento"}),(0,a.jsx)("span",{className:"text-gray-900",children:I(b.processedAt)})]})]}),N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{className:"my-6 border-gray-200"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Detalles de Transacci\xf3n"}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"ID de Transacci\xf3n"}),(0,a.jsx)("span",{className:"font-mono text-sm text-gray-900",children:N.id})]}),N.status_message&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Mensaje"}),(0,a.jsx)("span",{className:"text-gray-900",children:N.status_message})]})]})]})]}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:"APPROVED"===b.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.z,{onClick:()=>p.push("/dashboard"),className:"flex-1",children:["Ir al Dashboard",(0,a.jsx)(m.Z,{className:"w-4 h-4 ml-2"})]}),(0,a.jsxs)(x.z,{variant:"outline",onClick:()=>p.push("/dashboard/send"),className:"flex-1",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Enviar Mensajes"]})]}):"DECLINED"===b.status||"ERROR"===b.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.z,{onClick:()=>p.push("/dashboard/upgrade"),className:"flex-1",children:"Intentar Nuevamente"}),(0,a.jsx)(x.z,{variant:"outline",onClick:()=>p.push("/dashboard"),className:"flex-1",children:"Ir al Dashboard"})]}):(0,a.jsx)(x.z,{variant:"outline",onClick:()=>p.push("/dashboard"),className:"w-full",children:"Ir al Dashboard"})}),"APPROVED"!==b.status&&(0,a.jsxs)(g.Zb,{className:"bg-blue-50 border-blue-200",padding:"lg",children:[(0,a.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"\xbfNecesitas Ayuda?"}),(0,a.jsx)("p",{className:"text-blue-800 text-sm mb-4",children:"Si tienes problemas con tu pago o necesitas asistencia, no dudes en contactarnos."}),(0,a.jsx)(x.z,{variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:"Contactar Soporte"})]})]})}function y(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 mx-auto"}),(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}),children:(0,a.jsx)(p,{})})}},56426:function(e,r,t){"use strict";t.d(r,{z:function(){return d}});var a=t(57437),s=t(2265),n=t(90535),o=t(94508);let l={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function c(e){let{size:r="md",className:t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("animate-spin",l[r],t),children:(0,a.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"31.416",strokeDashoffset:"31.416",className:"opacity-25"}),(0,a.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",className:"opacity-75"})]})})}let i=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98] btn-hover-lift",{variants:{variant:{primary:"bg-primary text-white hover:bg-primary-600 shadow-lg hover:shadow-xl active:shadow-md",secondary:"bg-secondary text-white hover:bg-secondary-600 shadow-lg hover:shadow-xl active:shadow-md",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white shadow-md hover:shadow-lg",ghost:"text-primary hover:bg-primary/10 hover:text-primary-700",danger:"bg-danger text-white hover:bg-danger-600 shadow-lg hover:shadow-xl active:shadow-md"},size:{sm:"h-9 px-3 text-xs",md:"h-10 px-4 py-2",lg:"h-11 px-6 text-base",xl:"h-12 px-8 text-lg"}},defaultVariants:{variant:"primary",size:"md"}}),d=(0,s.forwardRef)((e,r)=>{let{className:t,variant:s,size:n,loading:l,children:d,disabled:u,...m}=e;return(0,a.jsxs)("button",{className:(0,o.cn)(i({variant:s,size:n,className:t})),ref:r,disabled:u||l,...m,children:[l&&(0,a.jsx)(c,{size:"sm",className:"mr-2"}),d]})});d.displayName="Button"},66070:function(e,r,t){"use strict";t.d(r,{Zb:function(){return c}});var a=t(57437),s=t(2265),n=t(90535),o=t(94508);let l=(0,n.j)("rounded-xl border bg-white text-gray-900 shadow-sm transition-all duration-300",{variants:{hover:{true:"card-hover cursor-pointer",false:""},padding:{none:"",sm:"p-3",md:"p-4",lg:"p-6",xl:"p-8"}},defaultVariants:{hover:!1,padding:"md"}}),c=(0,s.forwardRef)((e,r)=>{let{className:t,hover:s,padding:n,children:c,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)(l({hover:s,padding:n,className:t})),...i,children:c})});c.displayName="Card",(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5",t),...s})}).displayName="CardHeader",(0,s.forwardRef)((e,r)=>{let{className:t,children:s,...n}=e;return(0,a.jsx)("h3",{ref:r,className:(0,o.cn)("text-xl font-semibold leading-none tracking-tight",t),...n,children:s})}).displayName="CardTitle",(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,o.cn)("text-sm text-gray-600",t),...s})}).displayName="CardDescription",(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("pt-0",t),...s})}).displayName="CardContent",(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center pt-0",t),...s})}).displayName="CardFooter"},76362:function(e,r,t){"use strict";t.d(r,{a:function(){return n}});var a=t(2265),s=t(99376);function n(){let[e,r]=(0,a.useState)({user:null,loading:!0,error:null}),t=(0,s.useRouter)(),n=(0,a.useCallback)(async()=>{try{let e=localStorage.getItem("token");if(!e)return r({user:null,loading:!1,error:null}),!1;let t=await fetch("".concat("http://localhost:3005","/api/auth/me"),{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!t.ok)throw Error("Token inv\xe1lido");let a=await t.json();if(a.success)return r({user:a.user,loading:!1,error:null}),localStorage.setItem("user",JSON.stringify(a.user)),!0;throw Error(a.error||"Error de autenticaci\xf3n")}catch(e){return console.error("Error verificando autenticaci\xf3n:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),r({user:null,loading:!1,error:e instanceof Error?e.message:"Error de autenticaci\xf3n"}),!1}},[]),o=async(e,t)=>{r(e=>({...e,loading:!0,error:null}));try{let a=await fetch("".concat("http://localhost:3005","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:t})}),s=await a.json();if(s.success)return localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user)),r({user:s.user,loading:!1,error:null}),{success:!0};return r(e=>({...e,loading:!1,error:s.error||"Error al iniciar sesi\xf3n"})),{success:!1,error:s.error}}catch(t){let e="Error de conexi\xf3n. Por favor intente nuevamente.";return r(r=>({...r,loading:!1,error:e})),{success:!1,error:e}}},l=async(e,t,a)=>{r(e=>({...e,loading:!0,error:null}));try{let s=await fetch("".concat("http://localhost:3005","/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,email:t,password:a})}),n=await s.json();if(n.success)return localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n.user)),r({user:n.user,loading:!1,error:null}),{success:!0};return r(e=>({...e,loading:!1,error:n.error||"Error al registrar usuario"})),{success:!1,error:n.error}}catch(t){let e="Error de conexi\xf3n. Por favor intente nuevamente.";return r(r=>({...r,loading:!1,error:e})),{success:!1,error:e}}},c=(0,a.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),r({user:null,loading:!1,error:null}),t.push("/login")},[t]);return(0,a.useEffect)(()=>{n()},[n]),(0,a.useEffect)(()=>{if(e.user){let e=setInterval(()=>{n()},3e5);return()=>clearInterval(e)}},[e.user,n]),{user:e.user,loading:e.loading,error:e.error,isAuthenticated:!!e.user,login:o,register:l,logout:c,checkAuth:n}}},8530:function(e,r,t){"use strict";t.d(r,{T:function(){return a}});let a="http://localhost:3005"},94508:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var a=t(61994),s=t(53335);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}},76858:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},41671:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},99388:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},91723:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},88226:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},82431:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},76865:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},99376:function(e,r,t){"use strict";var a=t(35475);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[14,971,117,744],function(){return e(e.s=54381)}),_N_E=e.O()}]);