(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{4381:function(e,r,a){Promise.resolve().then(a.bind(a,688))},688:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return p}});var t=a(7437),s=a(2265),n=a(9376),o=a(1671),l=a(9388),c=a(6865),i=a(1723),d=a(7168),u=a(6858),m=a(8226),h=a(6426),x=a(6070),g=a(6362);function f(){let e;let{user:r,checkAuth:a}=(0,g.a)(),f=(0,n.useRouter)(),p=(0,n.useSearchParams)().get("reference"),[y,b]=(0,s.useState)(null),[j,N]=(0,s.useState)(null),[v,w]=(0,s.useState)(!0),[k,E]=(0,s.useState)(!1),[C,P]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!p){f.push("/dashboard");return}S();let e=setInterval(()=>{y&&["PENDING","IN_PROGRESS"].includes(y.status)&&S(!1)},5e3);return()=>clearInterval(e)},[p]);let S=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e&&w(!0),e||E(!0);try{let e=localStorage.getItem("token"),t=await fetch("http://localhost:3005/api/payments/transaction-status/".concat(p),{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&(b(s.payment),N(s.transaction),P(new Date),"APPROVED"===s.payment.status&&(null==r?void 0:r.planType)!==s.payment.planType&&await a(),console.log("Payment status response:",{status:s.payment.status,hasTransaction:!!s.transaction,note:s.note,wompiError:s.wompiError}))}catch(e){console.error("Error checking payment status:",e)}finally{w(!1),E(!1)}},D=e=>new Date(e).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(v)return(0,t.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 mx-auto"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})});if(!y)return(0,t.jsxs)("div",{className:"max-w-2xl mx-auto text-center space-y-6",children:[(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,t.jsx)(l.Z,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-red-900 mb-2",children:"Pago No Encontrado"}),(0,t.jsx)("p",{className:"text-red-700",children:"No pudimos encontrar informaci\xf3n sobre este pago."})]}),(0,t.jsx)(h.z,{onClick:()=>f.push("/dashboard"),children:"Ir al Dashboard"})]});let I=(e=>{switch(e){case"APPROVED":return{icon:o.Z,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",title:"\xa1Pago Exitoso!",message:"Tu plan ha sido actualizado correctamente."};case"DECLINED":return{icon:l.Z,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",title:"Pago Rechazado",message:"El pago fue rechazado. Por favor intenta con otro m\xe9todo de pago."};case"VOIDED":return{icon:l.Z,color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200",title:"Pago Anulado",message:"El pago fue anulado."};case"ERROR":return{icon:c.Z,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",title:"Error en el Pago",message:"Ocurri\xf3 un error procesando el pago. Por favor contacta soporte."};default:return{icon:i.Z,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",title:"Procesando Pago",message:"Tu pago est\xe1 siendo procesado. Esto puede tomar unos minutos."}}})(y.status),Z=I.icon;return(0,t.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,t.jsx)(x.Zb,{className:"".concat(I.bgColor," ").concat(I.borderColor," border"),padding:"lg",children:(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)(Z,{className:"w-16 h-16 ".concat(I.color," mx-auto")}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:I.title}),(0,t.jsx)("p",{className:"text-gray-700",children:I.message})]}),"PENDING"===y.status&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-3",children:[(0,t.jsx)(h.z,{variant:"outline",size:"sm",onClick:()=>S(!1),disabled:k,className:"hover:bg-blue-50 border-blue-300",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{className:"w-4 h-4 mr-1 animate-spin"}),"Consultando Wompi..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{className:"w-4 h-4 mr-1"}),"Verificar Estado Ahora"]})}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[(0,t.jsx)("p",{children:"\uD83D\uDCA1 Este bot\xf3n consulta directamente el estado en Wompi"}),(0,t.jsx)("p",{children:"Tambi\xe9n se verifica autom\xe1ticamente cada 5 segundos"}),C&&(0,t.jsxs)("p",{className:"text-green-600",children:["âœ“ \xdaltima verificaci\xf3n: ",C.toLocaleTimeString("es-CO")]})]})]})]})}),(0,t.jsxs)(x.Zb,{className:"bg-white",padding:"lg",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Detalles del Pago"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Referencia"}),(0,t.jsx)("span",{className:"font-mono text-sm text-gray-900",children:y.reference})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Plan"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:(e=>{switch(e){case"basic":return"Plan B\xe1sico";case"pro":return"Plan Pro";case"enterprise":return"Plan Enterprise";default:return e}})(y.planType)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Monto"}),(0,t.jsx)("span",{className:"font-bold text-gray-900",children:(e=y.amount,new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e))})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Estado"}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-sm font-medium ".concat("APPROVED"===y.status?"bg-green-100 text-green-800":"DECLINED"===y.status?"bg-red-100 text-red-800":"PENDING"===y.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:y.status})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Fecha de creaci\xf3n"}),(0,t.jsx)("span",{className:"text-gray-900",children:D(y.createdAt)})]}),y.processedAt&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Fecha de procesamiento"}),(0,t.jsx)("span",{className:"text-gray-900",children:D(y.processedAt)})]})]}),j&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{className:"my-6 border-gray-200"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Detalles de Transacci\xf3n"}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"ID de Transacci\xf3n"}),(0,t.jsx)("span",{className:"font-mono text-sm text-gray-900",children:j.id})]}),j.status_message&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Mensaje"}),(0,t.jsx)("span",{className:"text-gray-900",children:j.status_message})]})]})]})]}),(0,t.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:"APPROVED"===y.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.z,{onClick:()=>f.push("/dashboard"),className:"flex-1",children:["Ir al Dashboard",(0,t.jsx)(u.Z,{className:"w-4 h-4 ml-2"})]}),(0,t.jsxs)(h.z,{variant:"outline",onClick:()=>f.push("/dashboard/send"),className:"flex-1",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Enviar Mensajes"]})]}):"DECLINED"===y.status||"ERROR"===y.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.z,{onClick:()=>f.push("/dashboard/upgrade"),className:"flex-1",children:"Intentar Nuevamente"}),(0,t.jsx)(h.z,{variant:"outline",onClick:()=>f.push("/dashboard"),className:"flex-1",children:"Ir al Dashboard"})]}):(0,t.jsx)(h.z,{variant:"outline",onClick:()=>f.push("/dashboard"),className:"w-full",children:"Ir al Dashboard"})}),"APPROVED"!==y.status&&(0,t.jsxs)(x.Zb,{className:"bg-blue-50 border-blue-200",padding:"lg",children:[(0,t.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"\xbfNecesitas Ayuda?"}),(0,t.jsx)("p",{className:"text-blue-800 text-sm mb-4",children:"Si tienes problemas con tu pago o necesitas asistencia, no dudes en contactarnos."}),(0,t.jsx)(h.z,{variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:"Contactar Soporte"})]})]})}function p(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 mx-auto"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}),children:(0,t.jsx)(f,{})})}},6426:function(e,r,a){"use strict";a.d(r,{z:function(){return d}});var t=a(7437),s=a(2265),n=a(535),o=a(4508);let l={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function c(e){let{size:r="md",className:a}=e;return(0,t.jsx)("div",{className:(0,o.cn)("animate-spin",l[r],a),children:(0,t.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"31.416",strokeDashoffset:"31.416",className:"opacity-25"}),(0,t.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",className:"opacity-75"})]})})}let i=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98] btn-hover-lift",{variants:{variant:{primary:"bg-primary text-white hover:bg-primary-600 shadow-lg hover:shadow-xl active:shadow-md",secondary:"bg-secondary text-white hover:bg-secondary-600 shadow-lg hover:shadow-xl active:shadow-md",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white shadow-md hover:shadow-lg",ghost:"text-primary hover:bg-primary/10 hover:text-primary-700",danger:"bg-danger text-white hover:bg-danger-600 shadow-lg hover:shadow-xl active:shadow-md"},size:{sm:"h-9 px-3 text-xs",md:"h-10 px-4 py-2",lg:"h-11 px-6 text-base",xl:"h-12 px-8 text-lg"}},defaultVariants:{variant:"primary",size:"md"}}),d=(0,s.forwardRef)((e,r)=>{let{className:a,variant:s,size:n,loading:l,children:d,disabled:u,...m}=e;return(0,t.jsxs)("button",{className:(0,o.cn)(i({variant:s,size:n,className:a})),ref:r,disabled:u||l,...m,children:[l&&(0,t.jsx)(c,{size:"sm",className:"mr-2"}),d]})});d.displayName="Button"},6070:function(e,r,a){"use strict";a.d(r,{Zb:function(){return c}});var t=a(7437),s=a(2265),n=a(535),o=a(4508);let l=(0,n.j)("rounded-xl border bg-white text-gray-900 shadow-sm transition-all duration-300",{variants:{hover:{true:"card-hover cursor-pointer",false:""},padding:{none:"",sm:"p-3",md:"p-4",lg:"p-6",xl:"p-8"}},defaultVariants:{hover:!1,padding:"md"}}),c=(0,s.forwardRef)((e,r)=>{let{className:a,hover:s,padding:n,children:c,...i}=e;return(0,t.jsx)("div",{ref:r,className:(0,o.cn)(l({hover:s,padding:n,className:a})),...i,children:c})});c.displayName="Card",(0,s.forwardRef)((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5",a),...s})}).displayName="CardHeader",(0,s.forwardRef)((e,r)=>{let{className:a,children:s,...n}=e;return(0,t.jsx)("h3",{ref:r,className:(0,o.cn)("text-xl font-semibold leading-none tracking-tight",a),...n,children:s})}).displayName="CardTitle",(0,s.forwardRef)((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("p",{ref:r,className:(0,o.cn)("text-sm text-gray-600",a),...s})}).displayName="CardDescription",(0,s.forwardRef)((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,o.cn)("pt-0",a),...s})}).displayName="CardContent",(0,s.forwardRef)((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center pt-0",a),...s})}).displayName="CardFooter"},6362:function(e,r,a){"use strict";a.d(r,{a:function(){return n}});var t=a(2265),s=a(9376);function n(){let[e,r]=(0,t.useState)({user:null,loading:!0,error:null}),a=(0,s.useRouter)(),n=(0,t.useCallback)(async()=>{try{let e=localStorage.getItem("token");if(!e)return r({user:null,loading:!1,error:null}),!1;let a=await fetch("http://localhost:3005/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!a.ok)throw Error("Token inv\xe1lido");let t=await a.json();if(t.success)return r({user:t.user,loading:!1,error:null}),localStorage.setItem("user",JSON.stringify(t.user)),!0;throw Error(t.error||"Error de autenticaci\xf3n")}catch(e){return console.error("Error verificando autenticaci\xf3n:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),r({user:null,loading:!1,error:e instanceof Error?e.message:"Error de autenticaci\xf3n"}),!1}},[]),o=async(e,a)=>{r(e=>({...e,loading:!0,error:null}));try{let t=await fetch("http://localhost:3005/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:a})}),s=await t.json();if(s.success)return localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user)),r({user:s.user,loading:!1,error:null}),{success:!0};return r(e=>({...e,loading:!1,error:s.error||"Error al iniciar sesi\xf3n"})),{success:!1,error:s.error}}catch(a){let e="Error de conexi\xf3n. Por favor intente nuevamente.";return r(r=>({...r,loading:!1,error:e})),{success:!1,error:e}}},l=async(e,a,t)=>{r(e=>({...e,loading:!0,error:null}));try{let s=await fetch("http://localhost:3005/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,email:a,password:t})}),n=await s.json();if(n.success)return localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n.user)),r({user:n.user,loading:!1,error:null}),{success:!0};return r(e=>({...e,loading:!1,error:n.error||"Error al registrar usuario"})),{success:!1,error:n.error}}catch(a){let e="Error de conexi\xf3n. Por favor intente nuevamente.";return r(r=>({...r,loading:!1,error:e})),{success:!1,error:e}}},c=(0,t.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),r({user:null,loading:!1,error:null}),a.push("/login")},[a]);return(0,t.useEffect)(()=>{n()},[n]),(0,t.useEffect)(()=>{if(e.user){let e=setInterval(()=>{n()},3e5);return()=>clearInterval(e)}},[e.user,n]),{user:e.user,loading:e.loading,error:e.error,isAuthenticated:!!e.user,login:o,register:l,logout:c,checkAuth:n}}},4508:function(e,r,a){"use strict";a.d(r,{cn:function(){return n}});var t=a(1994),s=a(3335);function n(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,s.m6)((0,t.W)(r))}},6858:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},1671:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9388:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1723:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},8226:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},7168:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},6865:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},9376:function(e,r,a){"use strict";var t=a(5475);a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[14,971,117,744],function(){return e(e.s=4381)}),_N_E=e.O()}]);