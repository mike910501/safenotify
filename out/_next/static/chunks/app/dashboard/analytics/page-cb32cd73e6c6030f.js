(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[171],{34818:function(e,t,s){Promise.resolve().then(s.bind(s,76749))},76749:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var r=s(57437),a=s(2265),l=s(47625),n=s(21156),i=s(56940),o=s(97059),d=s(2027),c=s(78155),m=s(53250),u=s(52797),x=s(77031),h=s(40626),g=s(86810),f=s(10062),p=s(20407),v=s(5481),j=s(88822),y=s(82431),b=s(92735),N=s(44743),w=s(41671),k=s(49322),D=s(53417),C=s(70525),S=s(96215),E=s(40370),R=s(91723),z=s(66070),F=s(56426),T=s(43863),U=s(76362),Z=s(8530);function O(){let[e,t]=(0,a.useState)(null),[s,O]=(0,a.useState)(!0),[P,B]=(0,a.useState)(new Date),[M,A]=(0,a.useState)(!0),{user:I}=(0,U.a)();(0,a.useEffect)(()=>{L();let e=M?setInterval(()=>{L(!0)},3e4):null;return()=>{e&&clearInterval(e)}},[M]);let L=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e||O(!0);let s=localStorage.getItem("token");if(!s)return;let r=await fetch("".concat(Z.T,"/api/analytics/dashboard"),{headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let a=await r.json();if(a.success&&a.data)console.log("✅ Real analytics data received:",a.data),t(a.data),B(new Date);else{console.warn("⚠️ No real data available, using mock data. Error:",a.error||"Unknown error");let e={dailyMessages:K(),campaignPerformance:[{name:"Recordatorio Citas",sent:150,delivered:142,deliveryRate:94.7},{name:"Confirmaci\xf3n Pago",sent:89,delivered:85,deliveryRate:95.5},{name:"Promoci\xf3n Servicios",sent:67,delivered:61,deliveryRate:91},{name:"Encuesta Satisfacci\xf3n",sent:45,delivered:43,deliveryRate:95.6}],templateUsage:[{name:"Recordatorios",usage:45,color:"#8B5CF6"},{name:"Confirmaciones",usage:30,color:"#06B6D4"},{name:"Promociones",usage:15,color:"#10B981"},{name:"Encuestas",usage:10,color:"#F59E0B"}],deliveryStats:{total:(null==I?void 0:I.messagesUsed)||0,delivered:Math.floor(.94*((null==I?void 0:I.messagesUsed)||0)),failed:Math.floor(.06*((null==I?void 0:I.messagesUsed)||0)),pending:0,deliveryRate:94.2}};t(e),B(new Date)}}catch(e){console.error("❌ Error fetching analytics:",e),e.message.includes("401")?console.error("\uD83D\uDD12 Authentication error - user needs to re-login"):e.message.includes("500")&&console.error("\uD83D\uDD27 Server error - backend may be down"),t({dailyMessages:K(),campaignPerformance:[{name:"Error: Sin conexi\xf3n",sent:0,delivered:0,deliveryRate:0}],templateUsage:[{name:"Error de conexi\xf3n",usage:100,color:"#8B5CF6"}],deliveryStats:{total:(null==I?void 0:I.messagesUsed)||0,delivered:Math.floor(.94*((null==I?void 0:I.messagesUsed)||0)),failed:Math.floor(.06*((null==I?void 0:I.messagesUsed)||0)),pending:0,deliveryRate:94.2}}),B(new Date)}finally{e||O(!1)}},K=()=>{let e=[];for(let t=29;t>=0;t--){let s=new Date;s.setDate(s.getDate()-t);let r=Math.floor(50*Math.random())+10,a=Math.floor(r*(.9+.1*Math.random())),l=r-a;e.push({date:s.toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit"}),sent:r,delivered:a,failed:l})}return e},W=async()=>{try{let t=localStorage.getItem("token");if(!t)return;let s=await fetch("".concat(Z.T,"/api/analytics/export?format=csv"),{headers:{Authorization:"Bearer ".concat(t)}});if(s.ok){let e=await s.blob(),t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="safenotify-analytics-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)}else{if(!e)return;let t=[["Fecha","Enviados","Entregados","Fallidos"],...e.dailyMessages.map(e=>[e.date,e.sent,e.delivered,e.failed])].map(e=>e.join(",")).join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),a=URL.createObjectURL(s);r.setAttribute("href",a),r.setAttribute("download","safenotify-analytics-".concat(new Date().toISOString().split("T")[0],".csv")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}catch(e){console.error("Error exporting CSV:",e),alert("Error al exportar datos. Por favor intenta de nuevo.")}};return s&&!e?(0,r.jsxs)("div",{className:"space-y-6 animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,r.jsx)("div",{className:"h-32 bg-gray-200 rounded-xl"},e))}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"h-96 bg-gray-200 rounded-xl"}),(0,r.jsx)("div",{className:"h-96 bg-gray-200 rounded-xl"})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDCCA Analytics Dashboard"}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:["\xdaltima actualizaci\xf3n: ",P.toLocaleTimeString("es-CO")]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[(0,r.jsxs)(F.z,{variant:"outline",size:"sm",onClick:()=>A(!M),className:M?"bg-green-50 text-green-700":"",children:[(0,r.jsx)(y.Z,{className:"w-4 h-4 mr-2 ".concat(M?"animate-spin":"")}),M?"Auto-refresh ON":"Auto-refresh OFF"]}),(0,r.jsxs)(F.z,{variant:"outline",size:"sm",onClick:W,children:[(0,r.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"CSV"]}),(0,r.jsxs)(F.z,{variant:"outline",size:"sm",onClick:()=>{alert("Funcionalidad de exportaci\xf3n a PDF pr\xf3ximamente")},children:[(0,r.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"PDF"]}),(0,r.jsxs)(F.z,{size:"sm",onClick:()=>L(),children:[(0,r.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Actualizar"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(z.Zb,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",padding:"lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-600 mb-1",children:"Total Enviados"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:(null==e?void 0:e.deliveryStats.total)||0}),(0,r.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"\xdaltimos 30 d\xedas"})]}),(0,r.jsx)(T.Y,{icon:N.Z,size:24,className:"text-blue-500",animation:"pulse"})]})}),(0,r.jsx)(z.Zb,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",padding:"lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600 mb-1",children:"Entregados"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:(null==e?void 0:e.deliveryStats.delivered)||0}),(0,r.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:[null==e?void 0:e.deliveryStats.deliveryRate.toFixed(1),"% tasa entrega"]})]}),(0,r.jsx)(T.Y,{icon:w.Z,size:24,className:"text-green-500",animation:"pulse"})]})}),(0,r.jsx)(z.Zb,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",padding:"lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-red-600 mb-1",children:"Fallidos"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-900",children:(null==e?void 0:e.deliveryStats.failed)||0}),(0,r.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:[(((null==e?void 0:e.deliveryStats.failed)||0)/((null==e?void 0:e.deliveryStats.total)||1)*100).toFixed(1),"% tasa fallo"]})]}),(0,r.jsx)(T.Y,{icon:k.Z,size:24,className:"text-red-500",animation:"pulse"})]})}),(0,r.jsx)(z.Zb,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",padding:"lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-purple-600 mb-1",children:"Disponibles"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:((null==I?void 0:I.messagesLimit)||0)-((null==I?void 0:I.messagesUsed)||0)}),(0,r.jsxs)("p",{className:"text-xs text-purple-600 mt-1",children:["Plan ",(null==I?void 0:I.planType)||"free"]})]}),(0,r.jsx)(T.Y,{icon:D.Z,size:24,className:"text-purple-500",animation:"pulse"})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(z.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"\uD83D\uDCC8 Mensajes \xdaltimos 30 D\xedas"}),(0,r.jsx)(C.Z,{className:"w-5 h-5 text-green-500"})]}),(0,r.jsx)(l.h,{width:"100%",height:300,children:(0,r.jsxs)(n.w,{data:null==e?void 0:e.dailyMessages,children:[(0,r.jsx)(i.q,{strokeDasharray:"3 3",opacity:.3}),(0,r.jsx)(o.K,{dataKey:"date",tick:{fontSize:12}}),(0,r.jsx)(d.Q,{tick:{fontSize:12}}),(0,r.jsx)(c.u,{contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px"}}),(0,r.jsx)(m.D,{}),(0,r.jsx)(u.x,{type:"monotone",dataKey:"sent",stroke:"#8B5CF6",strokeWidth:2,name:"Enviados",dot:{fill:"#8B5CF6",strokeWidth:2,r:4}}),(0,r.jsx)(u.x,{type:"monotone",dataKey:"delivered",stroke:"#10B981",strokeWidth:2,name:"Entregados",dot:{fill:"#10B981",strokeWidth:2,r:4}}),(0,r.jsx)(u.x,{type:"monotone",dataKey:"failed",stroke:"#EF4444",strokeWidth:2,name:"Fallidos",dot:{fill:"#EF4444",strokeWidth:2,r:4}})]})})]}),(0,r.jsxs)(z.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"\uD83D\uDCCA Performance por Campa\xf1a"}),(0,r.jsx)(S.Z,{className:"w-5 h-5 text-blue-500"})]}),(0,r.jsx)(l.h,{width:"100%",height:300,children:(0,r.jsxs)(x.v,{data:null==e?void 0:e.campaignPerformance,children:[(0,r.jsx)(i.q,{strokeDasharray:"3 3",opacity:.3}),(0,r.jsx)(o.K,{dataKey:"name",tick:{fontSize:11},interval:0,angle:-45,textAnchor:"end",height:80}),(0,r.jsx)(d.Q,{tick:{fontSize:12}}),(0,r.jsx)(c.u,{contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px"},formatter:(e,t)=>["deliveryRate"===t?"".concat(e,"%"):e,"sent"===t?"Enviados":"delivered"===t?"Entregados":"Tasa Entrega"]}),(0,r.jsx)(m.D,{}),(0,r.jsx)(h.$,{dataKey:"sent",fill:"#8B5CF6",name:"Enviados",radius:[2,2,0,0]}),(0,r.jsx)(h.$,{dataKey:"delivered",fill:"#10B981",name:"Entregados",radius:[2,2,0,0]})]})})]}),(0,r.jsxs)(z.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"\uD83E\uDD67 Uso por Template"}),(0,r.jsx)(E.Z,{className:"w-5 h-5 text-purple-500"})]}),(0,r.jsx)(l.h,{width:"100%",height:300,children:(0,r.jsxs)(g.u,{children:[(0,r.jsx)(f.b,{data:null==e?void 0:e.templateUsage,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:s}=e;return"".concat(t," ").concat((100*s).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"usage",children:null==e?void 0:e.templateUsage.map((e,t)=>(0,r.jsx)(p.b,{fill:e.color},"cell-".concat(t)))}),(0,r.jsx)(c.u,{formatter:e=>["".concat(e,"%"),"Uso"],contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px"}})]})})]}),(0,r.jsxs)(z.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"\uD83D\uDCC8 Tendencia de Entrega"}),(0,r.jsx)(R.Z,{className:"w-5 h-5 text-orange-500"})]}),(0,r.jsx)(l.h,{width:"100%",height:300,children:(0,r.jsxs)(v.T,{data:null==e?void 0:e.dailyMessages,children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"colorDelivered",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.8}),(0,r.jsx)("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:.1})]})}),(0,r.jsx)(i.q,{strokeDasharray:"3 3",opacity:.3}),(0,r.jsx)(o.K,{dataKey:"date",tick:{fontSize:12}}),(0,r.jsx)(d.Q,{tick:{fontSize:12}}),(0,r.jsx)(c.u,{contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px"}}),(0,r.jsx)(j.uN,{type:"monotone",dataKey:"delivered",stroke:"#10B981",fillOpacity:1,fill:"url(#colorDelivered)",strokeWidth:2})]})})]})]}),(0,r.jsxs)(z.Zb,{className:"p-6 bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCA1 Insights y Recomendaciones"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-medium text-green-700 mb-2",children:"✅ Rendimiento Excelente"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Tu tasa de entrega del ",null==e?void 0:e.deliveryStats.deliveryRate.toFixed(1),"% est\xe1 por encima del promedio de la industria (92%)."]})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-medium text-blue-700 mb-2",children:"\uD83D\uDCCA Template M\xe1s Efectivo"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Los recordatorios de cita tienen la mayor tasa de uso. Considera crear m\xe1s templates similares."})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-medium text-orange-700 mb-2",children:"⏰ Mejor Horario"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Los mensajes enviados entre 9:00 AM y 5:00 PM tienen mejor tasa de entrega."})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-medium text-purple-700 mb-2",children:"\uD83C\uDFAF Progreso del Plan"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Plan ",(null==I?void 0:I.planType)||"free",": ",(null==I?void 0:I.messagesUsed)||0," de ",(null==I?void 0:I.messagesLimit)||10," mensajes"]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(((null==I?void 0:I.messagesUsed)||0)/((null==I?void 0:I.messagesLimit)||1)*100,100),"%")}})}),(0,r.jsxs)("p",{className:"text-xs text-purple-600",children:[(((null==I?void 0:I.messagesUsed)||0)/((null==I?void 0:I.messagesLimit)||1)*100).toFixed(1),"% utilizado"]})]})]})]})]})]})}},43863:function(e,t,s){"use strict";s.d(t,{Y:function(){return n}});var r=s(57437),a=s(94508);let l={pulse:"animate-pulse-fast",spin:"animate-spin-slow",bounce:"animate-bounce-subtle",none:""};function n(e){let{icon:t,animation:s="none",className:n,size:i=24,...o}=e;return(0,r.jsx)(t,{size:i,className:(0,a.cn)("transition-all duration-300",l[s],n),...o})}},56426:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var r=s(57437),a=s(2265),l=s(90535),n=s(94508);let i={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function o(e){let{size:t="md",className:s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("animate-spin",i[t],s),children:(0,r.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"31.416",strokeDashoffset:"31.416",className:"opacity-25"}),(0,r.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",className:"opacity-75"})]})})}let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98] btn-hover-lift",{variants:{variant:{primary:"bg-primary text-white hover:bg-primary-600 shadow-lg hover:shadow-xl active:shadow-md",secondary:"bg-secondary text-white hover:bg-secondary-600 shadow-lg hover:shadow-xl active:shadow-md",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white shadow-md hover:shadow-lg",ghost:"text-primary hover:bg-primary/10 hover:text-primary-700",danger:"bg-danger text-white hover:bg-danger-600 shadow-lg hover:shadow-xl active:shadow-md"},size:{sm:"h-9 px-3 text-xs",md:"h-10 px-4 py-2",lg:"h-11 px-6 text-base",xl:"h-12 px-8 text-lg"}},defaultVariants:{variant:"primary",size:"md"}}),c=(0,a.forwardRef)((e,t)=>{let{className:s,variant:a,size:l,loading:i,children:c,disabled:m,...u}=e;return(0,r.jsxs)("button",{className:(0,n.cn)(d({variant:a,size:l,className:s})),ref:t,disabled:m||i,...u,children:[i&&(0,r.jsx)(o,{size:"sm",className:"mr-2"}),c]})});c.displayName="Button"},66070:function(e,t,s){"use strict";s.d(t,{Zb:function(){return o}});var r=s(57437),a=s(2265),l=s(90535),n=s(94508);let i=(0,l.j)("rounded-xl border bg-white text-gray-900 shadow-sm transition-all duration-300",{variants:{hover:{true:"card-hover cursor-pointer",false:""},padding:{none:"",sm:"p-3",md:"p-4",lg:"p-6",xl:"p-8"}},defaultVariants:{hover:!1,padding:"md"}}),o=(0,a.forwardRef)((e,t)=>{let{className:s,hover:a,padding:l,children:o,...d}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)(i({hover:a,padding:l,className:s})),...d,children:o})});o.displayName="Card",(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5",s),...a})}).displayName="CardHeader",(0,a.forwardRef)((e,t)=>{let{className:s,children:a,...l}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-xl font-semibold leading-none tracking-tight",s),...l,children:a})}).displayName="CardTitle",(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-gray-600",s),...a})}).displayName="CardDescription",(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("pt-0",s),...a})}).displayName="CardContent",(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center pt-0",s),...a})}).displayName="CardFooter"},76362:function(e,t,s){"use strict";s.d(t,{a:function(){return l}});var r=s(2265),a=s(99376);function l(){let[e,t]=(0,r.useState)({user:null,loading:!0,error:null}),s=(0,a.useRouter)(),l=(0,r.useCallback)(async()=>{try{let e=localStorage.getItem("token");if(!e)return t({user:null,loading:!1,error:null}),!1;let s=await fetch("".concat("http://localhost:3005","/api/auth/me"),{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!s.ok)throw Error("Token inv\xe1lido");let r=await s.json();if(r.success)return t({user:r.user,loading:!1,error:null}),localStorage.setItem("user",JSON.stringify(r.user)),!0;throw Error(r.error||"Error de autenticaci\xf3n")}catch(e){return console.error("Error verificando autenticaci\xf3n:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),t({user:null,loading:!1,error:e instanceof Error?e.message:"Error de autenticaci\xf3n"}),!1}},[]),n=async(e,s)=>{t(e=>({...e,loading:!0,error:null}));try{let r=await fetch("".concat("http://localhost:3005","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:s})}),a=await r.json();if(a.success)return localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),t({user:a.user,loading:!1,error:null}),{success:!0};return t(e=>({...e,loading:!1,error:a.error||"Error al iniciar sesi\xf3n"})),{success:!1,error:a.error}}catch(s){let e="Error de conexi\xf3n. Por favor intente nuevamente.";return t(t=>({...t,loading:!1,error:e})),{success:!1,error:e}}},i=async(e,s,r)=>{t(e=>({...e,loading:!0,error:null}));try{let a=await fetch("".concat("http://localhost:3005","/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,email:s,password:r})}),l=await a.json();if(l.success)return localStorage.setItem("token",l.token),localStorage.setItem("user",JSON.stringify(l.user)),t({user:l.user,loading:!1,error:null}),{success:!0};return t(e=>({...e,loading:!1,error:l.error||"Error al registrar usuario"})),{success:!1,error:l.error}}catch(s){let e="Error de conexi\xf3n. Por favor intente nuevamente.";return t(t=>({...t,loading:!1,error:e})),{success:!1,error:e}}},o=(0,r.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t({user:null,loading:!1,error:null}),s.push("/login")},[s]);return(0,r.useEffect)(()=>{l()},[l]),(0,r.useEffect)(()=>{if(e.user){let e=setInterval(()=>{l()},3e5);return()=>clearInterval(e)}},[e.user,l]),{user:e.user,loading:e.loading,error:e.error,isAuthenticated:!!e.user,login:n,register:i,logout:o,checkAuth:l}}},8530:function(e,t,s){"use strict";s.d(t,{T:function(){return r}});let r="http://localhost:3005"},94508:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var r=s(61994),a=s(53335);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}}},function(e){e.O(0,[14,365,971,117,744],function(){return e(e.s=34818)}),_N_E=e.O()}]);