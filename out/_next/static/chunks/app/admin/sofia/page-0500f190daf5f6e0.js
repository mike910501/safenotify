(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[860],{36954:function(e,t,s){Promise.resolve().then(s.bind(s,44540))},44540:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(57437),r=s(2265),n=s(99376);function i(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[l,d]=(0,r.useState)(null),c=(0,n.useRouter)();(0,r.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=localStorage.getItem("token");if(!e){c.push("/login");return}let s=await fetch("https://safenotify-backend.onrender.com/api/admin/sofia/conversations",{headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok){if(403===s.status){d("Access denied. Admin role required.");return}throw Error("HTTP ".concat(s.status))}let a=await s.json();t(a.conversations||[])}catch(e){console.error("Error fetching data:",e),d("Error loading dashboard data: "+e.message)}finally{i(!1)}};return s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Loading Sofia Admin Dashboard..."})]})}):l?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-red-600 mb-4",children:["❌ ",l]}),(0,a.jsx)("button",{onClick:()=>c.push("/admin"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Back to Admin"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-xl",children:"\uD83E\uDD16"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Sofia AI - Dashboard de Leads"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Monitoreo de conversaciones de ventas para TODOS los negocios \uD83D\uDE80"})]})]}),(0,a.jsx)("button",{onClick:()=>c.push("/admin"),className:"mt-3 inline-flex items-center px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",children:"← Volver al Admin Principal"})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Total Conversations"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:e.length})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"A Grade Leads"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"A"===e.grade).length})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"B Grade Leads"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:e.filter(e=>"B"===e.grade).length})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Average Score"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:e.length>0?Math.round(e.reduce((e,t)=>e+t.qualificationScore,0)/e.length):0})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Recent Conversations (",e.length,")"]})}),0===e.length?(0,a.jsx)("div",{className:"px-6 py-8 text-center text-gray-500",children:"No conversations found. Start chatting with Sofia to see data here."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contacto"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipo de Negocio"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Score"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grado"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mensajes"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"\xdaltima Actividad"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name||"Sin nombre"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.phone}),e.email&&(0,a.jsx)("div",{className:"text-sm text-gray-400",children:e.email})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.specialty||"No identificada"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.qualificationScore}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("A"===e.grade?"text-green-600 bg-green-100":"B"===e.grade?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100"),children:e.grade})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.messageCount}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.lastActivity).toLocaleDateString("es-CO")})]},e.id))})]})})]}),(0,a.jsxs)("div",{className:"mt-8 bg-gray-100 p-4 rounded text-sm",children:[(0,a.jsx)("strong",{children:"Debug Info:"}),(0,a.jsx)("br",{}),"API Status: ",l?"Error":"OK",(0,a.jsx)("br",{}),"Conversations loaded: ",e.length,(0,a.jsx)("br",{}),"Last fetch: ",new Date().toLocaleTimeString()]})]})]})}},99376:function(e,t,s){"use strict";var a=s(35475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=36954)}),_N_E=e.O()}]);