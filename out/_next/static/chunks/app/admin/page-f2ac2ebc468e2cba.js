(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{64070:function(e,a,t){Promise.resolve().then(t.bind(t,39221))},39221:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return U}});var s=t(57437),r=t(2265),l=t(99376),n=t(8530),o=t(82222),i=t(91723),c=t(41671),d=t(99388),m=t(33276),x=t(76865),u=t(88906),p=t(82023),h=t(82431),b=t(48736),g=t(73247),y=t(79205);let j=(0,y.Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var f=t(53417),v=t(92369),N=t(31047),w=t(22135),k=t(40875);let C=(0,y.Z)("thumbs-up",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),T=(0,y.Z)("thumbs-down",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]),Z=(0,y.Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var z=t(18930),I=t(42208),E=t(11239),A=t(99397);let S=(0,y.Z)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var D=t(56426),L=t(66070),P=t(43863),R=t(76362),M=t(89534);function U(){let{user:e}=(0,R.a)(),a=(0,l.useRouter)(),t=(0,M.p)(),[y,I]=(0,r.useState)([]),[E,A]=(0,r.useState)(null),[S,U]=(0,r.useState)(!0),[q,H]=(0,r.useState)(null),[_,F]=(0,r.useState)(null),[O,K]=(0,r.useState)(null),[X,W]=(0,r.useState)(""),[Q,G]=(0,r.useState)("all"),[J,$]=(0,r.useState)(new Date),[ee,ea]=(0,r.useState)(!1),[et,es]=(0,r.useState)(!1),[er,el]=(0,r.useState)(!1),[en,eo]=(0,r.useState)(null),[ei,ec]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(e&&"admin"!==e.role){a.push("/dashboard");return}},[e,a]),(0,r.useEffect)(()=>{(null==e?void 0:e.role)==="admin"&&(ed(),em())},[e]),(0,r.useEffect)(()=>{(null==e?void 0:e.role)==="admin"&&ed()},[Q]);let ed=async()=>{try{U(!0);let e=localStorage.getItem("token"),a=new URLSearchParams;"all"!==Q&&a.append("status",Q),X.trim()&&a.append("search",X.trim());let t="".concat(n.T,"/api/admin/templates").concat(a.toString()?"?"+a.toString():""),s=await fetch(t,{headers:{Authorization:"Bearer ".concat(e)}}),r=await s.json();r.success&&(I(r.templates),$(new Date))}catch(e){console.error("Error fetching templates:",e)}finally{U(!1)}},em=async()=>{try{let e=localStorage.getItem("token"),a=await fetch("".concat(n.T,"/api/admin/templates/stats"),{headers:{Authorization:"Bearer ".concat(e)}}),t=await a.json();t.success&&A(t.stats)}catch(e){console.error("Error fetching stats:",e)}},ex=async e=>{if(confirm("\xbfAprobar esta plantilla?")){F(e+"-approve");try{let a=localStorage.getItem("token"),s=await fetch("".concat(n.T,"/api/admin/templates/").concat(e,"/approve"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({notes:"Aprobada desde panel admin"})}),r=await s.json();r.success?(t.success("Plantilla aprobada exitosamente","La plantilla ha sido aprobada y est\xe1 lista para activaci\xf3n"),ed(),em()):t.error("Error aprobando plantilla",r.error||"No se pudo aprobar la plantilla")}catch(e){console.error("Error approving template:",e),t.error("Error de conexi\xf3n","No se pudo conectar con el servidor. Verifica tu conexi\xf3n a internet")}finally{F(null)}}},eu=async e=>{let a=prompt("Raz\xf3n del rechazo (opcional):");if(confirm("\xbfRechazar esta plantilla?")){F(e+"-reject");try{let s=localStorage.getItem("token"),r=await fetch("".concat(n.T,"/api/admin/templates/").concat(e,"/reject"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({notes:a||"No cumple con pol\xedticas de WhatsApp"})}),l=await r.json();l.success?(t.warning("Plantilla rechazada","La plantilla ha sido marcada como rechazada"),ed(),em()):t.error("Error rechazando plantilla",l.error||"No se pudo rechazar la plantilla")}catch(e){console.error("Error rejecting template:",e),t.error("Error de conexi\xf3n","No se pudo conectar con el servidor. Verifica tu conexi\xf3n a internet")}finally{F(null)}}},ep=e=>{let a=y.find(a=>a.id===e);a&&(eo(a),es(!0))},eh=e=>{let a=y.find(a=>a.id===e);a&&(ec(a),el(!0))},eb=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar esta plantilla? Esta acci\xf3n no se puede deshacer.")){F(e+"-delete");try{let a=localStorage.getItem("token"),s=await fetch("".concat(n.T,"/api/admin/templates/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}}),r=await s.json();r.success?(t.success("Plantilla eliminada exitosamente","La plantilla ha sido eliminada permanentemente del sistema"),ed(),em()):t.error("Error eliminando plantilla",r.error||"No se pudo eliminar la plantilla")}catch(e){console.error("Error deleting template:",e),t.error("Error de conexi\xf3n","No se pudo conectar con el servidor. Verifica tu conexi\xf3n a internet")}finally{F(null)}}},eg=e=>{switch(e.status){case"ai_pending":return{icon:o.Z,color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200",text:"Validaci\xf3n IA"};case"pending":return{icon:i.Z,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",text:"Pendiente Revisi\xf3n"};case"approved":return{icon:c.Z,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",text:"Aprobada"};case"rejected":return{icon:d.Z,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",text:"Rechazada"};case"active":return{icon:m.Z,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",text:"Activa (Twilio)"};default:return{icon:x.Z,color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200",text:"Desconocido"}}};return S?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Cargando panel de administraci\xf3n..."})]})}):(null==e?void 0:e.role)!=="admin"?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.Z,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Acceso Denegado"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Necesitas permisos de administrador"})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-light-50 via-white to-primary-50/20",children:[(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-8",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-500/10 to-secondary-500/10 blur-3xl -z-10"}),(0,s.jsx)(L.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-xl",padding:"lg",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center space-y-4 lg:space-y-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-primary-500/20 blur-lg rounded-full"}),(0,s.jsx)(P.Y,{icon:u.Z,size:48,className:"text-primary-600 relative",animation:"pulse"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"Panel de Administraci\xf3n"}),(0,s.jsxs)("p",{className:"text-dark-500 mt-1 flex items-center space-x-2",children:[(0,s.jsx)(p.Z,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["Gesti\xf3n de plantillas WhatsApp • Actualizado: ",J.toLocaleTimeString()]})]})]})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)(D.z,{onClick:()=>a.push("/admin/sofia"),className:"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",size:"lg",children:[(0,s.jsx)(o.Z,{size:16,className:"mr-2"}),"Sofia Dashboard"]}),(0,s.jsxs)(D.z,{onClick:ed,className:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",size:"lg",children:[(0,s.jsx)(h.Z,{size:16,className:"mr-2"}),"Actualizar"]}),(0,s.jsxs)(D.z,{onClick:()=>ea(!0),className:"bg-gradient-to-r from-secondary-500 to-secondary-600 hover:from-secondary-600 hover:to-secondary-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",size:"lg",children:[(0,s.jsx)(p.Z,{size:16,className:"mr-2"}),"Crear Plantilla"]})]})]})})]}),E&&(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6",children:[(0,s.jsx)(L.Zb,{className:"bg-gradient-to-br from-accent-50 to-accent-100/50 border-accent-200 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",padding:"lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(P.Y,{icon:i.Z,size:32,className:"text-accent-600 mx-auto mb-3",animation:"pulse"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-accent-900",children:E.pending||0}),(0,s.jsx)("p",{className:"text-accent-700 text-sm font-medium",children:"Pendientes"})]})}),(0,s.jsx)(L.Zb,{className:"bg-gradient-to-br from-primary-50 to-primary-100/50 border-primary-200 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",padding:"lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(P.Y,{icon:c.Z,size:32,className:"text-primary-600 mx-auto mb-3",animation:"pulse"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-primary-900",children:E.approved||0}),(0,s.jsx)("p",{className:"text-primary-700 text-sm font-medium",children:"Aprobadas"})]})}),(0,s.jsx)(L.Zb,{className:"bg-gradient-to-br from-danger-50 to-danger-100/50 border-danger-200 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",padding:"lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(P.Y,{icon:d.Z,size:32,className:"text-danger-600 mx-auto mb-3",animation:"pulse"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-danger-900",children:E.rejected||0}),(0,s.jsx)("p",{className:"text-danger-700 text-sm font-medium",children:"Rechazadas"})]})}),(0,s.jsx)(L.Zb,{className:"bg-gradient-to-br from-secondary-50 to-secondary-100/50 border-secondary-200 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",padding:"lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(P.Y,{icon:m.Z,size:32,className:"text-secondary-600 mx-auto mb-3",animation:"pulse"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-secondary-900",children:E.active||0}),(0,s.jsx)("p",{className:"text-secondary-700 text-sm font-medium",children:"Activas"})]})}),(0,s.jsx)(L.Zb,{className:"bg-gradient-to-br from-dark-100 to-dark-200/50 border-dark-300 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",padding:"lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(P.Y,{icon:b.Z,size:32,className:"text-dark-600 mx-auto mb-3",animation:"pulse"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-dark-900",children:E.total||0}),(0,s.jsx)("p",{className:"text-dark-700 text-sm font-medium",children:"Total"})]})}),(0,s.jsx)(L.Zb,{className:"bg-gradient-to-br from-primary-100 to-secondary-100/50 border-primary-300 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",padding:"lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(P.Y,{icon:o.Z,size:32,className:"text-primary-700 mx-auto mb-3",animation:"pulse"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-primary-900",children:E.recentPending||0}),(0,s.jsx)("p",{className:"text-primary-700 text-sm font-medium",children:"Recientes"})]})})]}),(0,s.jsx)(L.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-lg",padding:"lg",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),ed()},className:"flex-1 flex gap-3",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-500/5 to-secondary-500/5 rounded-lg"}),(0,s.jsx)(g.Z,{className:"w-5 h-5 absolute left-4 top-1/2 transform -translate-y-1/2 text-primary-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Buscar por nombre, contenido, usuario...",value:X,onChange:e=>W(e.target.value),className:"w-full pl-12 pr-4 py-3 bg-transparent border-2 border-primary-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-dark-700 placeholder-dark-400"})]}),(0,s.jsxs)(D.z,{type:"submit",className:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white px-8 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",children:[(0,s.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"Buscar"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-dark-600",children:[(0,s.jsx)(j,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Filtrar:"})]}),(0,s.jsxs)("select",{value:Q,onChange:e=>G(e.target.value),className:"px-4 py-3 bg-white border-2 border-primary-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-dark-700 font-medium min-w-[200px]",children:[(0,s.jsx)("option",{value:"all",children:"✨ Todos los estados"}),(0,s.jsx)("option",{value:"ai_pending",children:"\uD83E\uDD16 Validaci\xf3n IA"}),(0,s.jsx)("option",{value:"pending",children:"⏳ Pendientes"}),(0,s.jsx)("option",{value:"approved",children:"✅ Aprobadas"}),(0,s.jsx)("option",{value:"rejected",children:"❌ Rechazadas"}),(0,s.jsx)("option",{value:"active",children:"\uD83D\uDE80 Activas"})]})]})]})}),(0,s.jsxs)(L.Zb,{className:"bg-white/90 backdrop-blur-sm border-0 shadow-lg",padding:"lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(P.Y,{icon:f.Z,size:28,className:"text-primary-600",animation:"pulse"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:["Plantillas (",y.length,")"]}),"all"!==Q&&(0,s.jsxs)("p",{className:"text-sm text-dark-500 flex items-center mt-1",children:[(0,s.jsx)(j,{className:"w-3 h-3 mr-1"}),"Filtrado por: ",(0,s.jsx)("span",{className:"font-medium ml-1",children:Q})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-secondary-500 rounded-full animate-pulse"}),(0,s.jsx)("span",{className:"text-sm text-dark-500",children:"En vivo"})]})]}),0===y.length?(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-primary-500/10 blur-2xl rounded-full"}),(0,s.jsx)(P.Y,{icon:f.Z,size:80,className:"text-primary-400 mx-auto relative",animation:"pulse"})]}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-dark-700 mb-2",children:"all"===Q?"\uD83D\uDD0D No hay plantillas":"\uD83D\uDD0D No hay plantillas ".concat(Q)}),(0,s.jsx)("p",{className:"text-dark-500 max-w-md mx-auto",children:"pending"===Q?"⏳ Los usuarios a\xfan no han creado plantillas para revisar. \xa1Pronto aparecer\xe1n aqu\xed!":"\uD83D\uDD04 Cambia el filtro para ver otras plantillas o crea nuevas plantillas."})]}):(0,s.jsx)("div",{className:"space-y-4",children:y.map(e=>{var a,t,r;let l=eg(e),n=O===e.id;return(0,s.jsxs)("div",{className:"group bg-white border border-light-200 rounded-xl shadow-sm hover:shadow-xl transition-all duration-500 transform hover:-translate-y-1 overflow-hidden",children:[(0,s.jsx)("div",{className:"p-6 cursor-pointer transition-all duration-300 ".concat(l.bgColor," hover:bg-opacity-80"),onClick:()=>K(n?null:e.id),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 ".concat(l.color.replace("text-","bg-").replace("-600","-500/20")," blur-md rounded-full")}),(0,s.jsx)(P.Y,{icon:l.icon,size:24,className:"".concat(l.color," relative"),animation:"pulse"})]}),(0,s.jsx)("h3",{className:"text-lg font-bold text-dark-800 group-hover:text-primary-600 transition-colors duration-300",children:e.name})]}),(0,s.jsx)("div",{className:"px-4 py-2 rounded-full text-sm font-medium ".concat(l.bgColor," ").concat(l.color," border ").concat(l.borderColor," shadow-sm"),children:l.text}),e.aiApproved&&(0,s.jsxs)("div",{className:"px-3 py-2 rounded-full text-sm font-medium bg-gradient-to-r from-secondary-100 to-secondary-50 text-secondary-800 border border-secondary-200 shadow-sm flex items-center space-x-1",children:[(0,s.jsx)(o.Z,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["IA: ",e.aiScore,"/100"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[e.user?(0,s.jsxs)("div",{className:"text-sm text-dark-600 flex items-center space-x-1 bg-light-100 px-3 py-2 rounded-lg",children:[(0,s.jsx)(v.Z,{size:16,className:"text-primary-500"}),(0,s.jsx)("span",{className:"font-medium",children:(null===(a=e.user)||void 0===a?void 0:a.name)||"Sistema"})]}):(0,s.jsxs)("div",{className:"text-sm text-dark-600 flex items-center space-x-1 bg-blue-100 px-3 py-2 rounded-lg",children:[(0,s.jsx)(v.Z,{size:16,className:"text-blue-500"}),(0,s.jsx)("span",{className:"font-medium",children:"\uD83C\uDFE2 Plantilla del Sistema"})]}),(0,s.jsxs)("div",{className:"text-sm text-dark-500 flex items-center space-x-1",children:[(0,s.jsx)(N.Z,{size:16,className:"text-accent-500"}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString()})]}),(0,s.jsx)("div",{className:"p-2 rounded-lg hover:bg-white/50 transition-colors duration-200",children:n?(0,s.jsx)(w.Z,{size:24,className:"text-primary-600"}):(0,s.jsx)(k.Z,{size:24,className:"text-dark-400 group-hover:text-primary-600 transition-colors duration-300"})})]})]})}),n&&(0,s.jsxs)("div",{className:"border-t border-light-200 bg-gradient-to-br from-white to-light-50/50 p-8 animate-slide-down",children:[(0,s.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8 mb-8",children:[(0,s.jsxs)(L.Zb,{className:"bg-white/80 backdrop-blur-sm border-light-200 shadow-sm",padding:"lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,s.jsx)(v.Z,{className:"w-5 h-5 text-primary-600"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-dark-800",children:"Informaci\xf3n"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Usuario:"}),(0,s.jsx)("span",{className:"text-dark-800 font-semibold",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"Sistema"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Email:"}),(0,s.jsx)("span",{className:"text-sm text-dark-700",children:(null===(r=e.user)||void 0===r?void 0:r.email)||"sistema@safenotify.com"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Categor\xeda:"}),(0,s.jsx)("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 rounded text-sm font-medium",children:e.category})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Variables:"}),(0,s.jsx)("span",{className:"text-sm text-dark-700 max-w-48 truncate",children:e.variables.length>0?e.variables.join(", "):"❌ Ninguna"})]}),(0,s.jsxs)("div",{className:"p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600 block mb-2",children:"ID:"}),(0,s.jsx)("code",{className:"bg-dark-100 px-3 py-2 rounded-md text-xs font-mono text-dark-700 block break-all",children:e.id})]}),e.twilioTemplateId&&(0,s.jsxs)("div",{className:"p-3 bg-primary-50 rounded-lg border border-primary-200",children:[(0,s.jsx)("span",{className:"font-medium text-primary-700 block mb-2",children:"Twilio Template ID:"}),(0,s.jsx)("code",{className:"bg-primary-100 px-3 py-2 rounded-md text-xs font-mono text-primary-800 block break-all",children:e.twilioTemplateId})]}),e.twilioContentSid&&(0,s.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[(0,s.jsx)("span",{className:"font-medium text-green-700 block mb-2",children:"WhatsApp Content SID:"}),(0,s.jsx)("code",{className:"bg-green-100 px-3 py-2 rounded-md text-xs font-mono text-green-800 block break-all",children:e.twilioContentSid})]}),e.language&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Idioma:"}),(0,s.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm font-medium",children:e.language.toUpperCase()})]}),e.businessCategory&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Categor\xeda WhatsApp:"}),(0,s.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded text-sm font-medium",children:e.businessCategory})]}),e.headerText&&(0,s.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsx)("span",{className:"font-medium text-blue-700 block mb-2",children:"Header Text:"}),(0,s.jsx)("p",{className:"text-sm text-blue-800",children:e.headerText})]}),e.footerText&&(0,s.jsxs)("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,s.jsx)("span",{className:"font-medium text-yellow-700 block mb-2",children:"Footer Text:"}),(0,s.jsx)("p",{className:"text-sm text-yellow-800",children:e.footerText})]})]})]}),(0,s.jsxs)(L.Zb,{className:"bg-white/80 backdrop-blur-sm border-light-200 shadow-sm",padding:"lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,s.jsx)(o.Z,{className:"w-5 h-5 text-secondary-600"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-dark-800",children:"An\xe1lisis IA"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Estado IA:"}),(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-bold ".concat(e.aiApproved?"bg-secondary-100 text-secondary-800":"bg-danger-100 text-danger-800"),children:e.aiApproved?"✅ Aprobado":"❌ Rechazado"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-light-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium text-dark-600",children:"Score:"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-20 bg-dark-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat((e.aiScore||0)>=80?"bg-secondary-500":(e.aiScore||0)>=60?"bg-accent-500":"bg-danger-500"),style:{width:"".concat(e.aiScore||0,"%")}})}),(0,s.jsxs)("span",{className:"font-bold text-dark-800",children:[e.aiScore||0,"/100"]})]})]}),e.aiReasons.length>0&&(0,s.jsxs)("div",{className:"p-4 bg-primary-50 rounded-lg border border-primary-200",children:[(0,s.jsxs)("h5",{className:"font-semibold text-primary-800 mb-2 flex items-center",children:[(0,s.jsx)(x.Z,{className:"w-4 h-4 mr-1"}),"Razones:"]}),(0,s.jsx)("ul",{className:"space-y-1",children:e.aiReasons.map((e,a)=>(0,s.jsxs)("li",{className:"text-sm text-primary-700 flex items-start space-x-2",children:[(0,s.jsx)("span",{className:"text-primary-500 mt-1",children:"•"}),(0,s.jsx)("span",{children:e})]},a))})]})]})]})]}),(0,s.jsxs)(L.Zb,{className:"bg-gradient-to-br from-light-50 to-white border-light-200 shadow-sm mb-8",padding:"lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 text-accent-600"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-dark-800",children:"Contenido del Mensaje"})]}),(0,s.jsxs)("div",{className:"bg-white border-2 border-light-200 rounded-xl p-6 shadow-inner",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-primary-500 to-secondary-500 w-12 h-1 rounded-full mb-4"}),(0,s.jsx)("p",{className:"text-dark-700 whitespace-pre-wrap leading-relaxed font-medium",children:e.content}),(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsxs)("div",{className:"text-xs text-dark-400 bg-light-100 px-2 py-1 rounded",children:[e.content.length," caracteres"]})})]})]}),e.aiSuggestions.length>0&&(0,s.jsxs)(L.Zb,{className:"bg-gradient-to-br from-secondary-50 to-secondary-100/50 border-secondary-200 shadow-sm mb-8",padding:"lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,s.jsx)(p.Z,{className:"w-5 h-5 text-secondary-600"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-secondary-800",children:"Sugerencia de IA"})]}),(0,s.jsx)("div",{className:"bg-white/90 border border-secondary-200 rounded-xl p-6",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(o.Z,{className:"w-8 h-8 text-secondary-600 bg-secondary-100 p-2 rounded-lg"})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("p",{className:"text-secondary-800 whitespace-pre-wrap leading-relaxed font-medium",children:e.aiSuggestions[0]})})]})})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 pt-6 border-t-2 border-light-200",children:["pending"===e.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(D.z,{onClick:()=>ex(e.id),disabled:_===e.id+"-approve",className:"bg-gradient-to-r from-secondary-500 to-secondary-600 hover:from-secondary-600 hover:to-secondary-700 text-white px-6 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(C,{size:18,className:"mr-2"}),_===e.id+"-approve"?"⏳ Aprobando...":"✅ Aprobar"]}),(0,s.jsxs)(D.z,{onClick:()=>eu(e.id),disabled:_===e.id+"-reject",className:"bg-gradient-to-r from-danger-500 to-danger-600 hover:from-danger-600 hover:to-danger-700 text-white px-6 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(T,{size:18,className:"mr-2"}),_===e.id+"-reject"?"⏳ Rechazando...":"❌ Rechazar"]})]}),"approved"===e.status&&(0,s.jsxs)(D.z,{onClick:()=>ep(e.id),disabled:_===e.id+"-activate",className:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white px-8 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(m.Z,{size:18,className:"mr-2"}),_===e.id+"-activate"?"⏳ Activando...":"\uD83D\uDE80 Activar con Twilio"]}),(0,s.jsxs)(D.z,{onClick:()=>eh(e.id),className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-6 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",children:[(0,s.jsx)(Z,{size:18,className:"mr-2"}),"✏️ Editar"]}),(0,s.jsxs)(D.z,{onClick:()=>eb(e.id),disabled:_===e.id+"-delete",className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-6 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(z.Z,{size:18,className:"mr-2"}),_===e.id+"-delete"?"⏳ Eliminando...":"\uD83D\uDDD1️ Eliminar"]}),"active"===e.status&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-secondary-100 to-secondary-50 text-secondary-800 px-6 py-3 rounded-xl border border-secondary-200 shadow-sm",children:[(0,s.jsx)(P.Y,{icon:c.Z,size:20,className:"text-secondary-600",animation:"pulse"}),(0,s.jsx)("span",{className:"font-bold",children:"\uD83C\uDF89 Plantilla activa y lista para usar"})]}),"rejected"===e.status&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 bg-gradient-to-r from-danger-100 to-danger-50 text-danger-800 px-6 py-3 rounded-xl border border-danger-200 shadow-sm",children:[(0,s.jsx)(d.Z,{size:20,className:"text-danger-600"}),(0,s.jsx)("span",{className:"font-bold",children:"\uD83D\uDC94 Plantilla rechazada"})]})]})]})]},e.id)})})]})]}),(0,s.jsx)(V,{isOpen:ee,onClose:()=>ea(!1),onSuccess:()=>{ea(!1),ed(),em()},toast:t}),(0,s.jsx)(B,{isOpen:et,onClose:()=>{es(!1),eo(null)},template:en,onSuccess:()=>{es(!1),eo(null),ed(),em()},toast:t,setActionLoading:F,actionLoading:_}),(0,s.jsx)(Y,{isOpen:er,onClose:()=>{el(!1),ec(null)},template:ei,onSuccess:()=>{el(!1),ec(null),ed(),em()},toast:t})]})}function B(e){let{isOpen:a,onClose:t,template:l,onSuccess:o,toast:i,setActionLoading:c,actionLoading:x}=e,[u,p]=(0,r.useState)({twilioTemplateId:"",twilioContentSid:"",headerText:"",footerText:"",language:"es",businessCategory:"UTILITY"});(0,r.useEffect)(()=>{l&&p({twilioTemplateId:l.twilioTemplateId||"",twilioContentSid:l.twilioContentSid||"",headerText:l.headerText||"",footerText:l.footerText||"",language:l.language||"es",businessCategory:l.businessCategory||"UTILITY"})},[l]);let g=async e=>{if(e.preventDefault(),l){if(!u.twilioTemplateId.trim()){i.error("Campo requerido","El Template ID de Twilio es obligatorio");return}c(l.id+"-activate");try{let e=localStorage.getItem("token"),a=await fetch("".concat(n.T,"/api/admin/templates/").concat(l.id,"/activate"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(u)}),t=await a.json();t.success?(i.success("Plantilla activada exitosamente","La plantilla est\xe1 ahora activa con configuraci\xf3n WhatsApp Business y lista para env\xedo"),o()):i.error("Error activando plantilla",t.error||"No se pudo activar la plantilla")}catch(e){console.error("Error activating template:",e),i.error("Error de conexi\xf3n","No se pudo conectar con el servidor. Verifica tu conexi\xf3n a internet")}finally{c(null)}}};if(!a||!l)return null;let y=x===l.id+"-activate";return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"Activar Plantilla con WhatsApp Business"}),(0,s.jsxs)("p",{className:"text-gray-600 mt-2",children:['Configurar "',l.name,'" para env\xedo de mensajes']})]}),(0,s.jsx)(D.z,{onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 p-3 rounded-lg",disabled:y,children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 mr-2 text-green-600"}),"Configuraci\xf3n de WhatsApp Business"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template ID de Twilio/WhatsApp *"}),(0,s.jsx)("input",{type:"text",required:!0,value:u.twilioTemplateId,onChange:e=>p({...u,twilioTemplateId:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"HX..."}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"ID de la plantilla aprobada en WhatsApp Business Manager"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content SID de Twilio (opcional)"}),(0,s.jsx)("input",{type:"text",value:u.twilioContentSid,onChange:e=>p({...u,twilioContentSid:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"HX... (opcional)"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Idioma"}),(0,s.jsxs)("select",{value:u.language,onChange:e=>p({...u,language:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,s.jsx)("option",{value:"en",children:"English"}),(0,s.jsx)("option",{value:"pt",children:"Portugu\xeas"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda Business"}),(0,s.jsxs)("select",{value:u.businessCategory,onChange:e=>p({...u,businessCategory:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"UTILITY",children:"Utilidad"}),(0,s.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,s.jsx)("option",{value:"AUTHENTICATION",children:"Autenticaci\xf3n"})]})]})]})]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(b.Z,{className:"w-5 h-5 mr-2 text-blue-600"}),"Textos Adicionales (Opcional)"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Header Text"}),(0,s.jsx)("input",{type:"text",value:u.headerText,onChange:e=>p({...u,headerText:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Texto del encabezado (opcional)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Footer Text"}),(0,s.jsx)("input",{type:"text",value:u.footerText,onChange:e=>p({...u,footerText:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Texto del pie de p\xe1gina (opcional)"})]})]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(I.Z,{className:"w-5 h-5 mr-2 text-purple-600"}),"Vista Previa de la Plantilla"]}),(0,s.jsx)("div",{className:"bg-gray-50 border-2 border-gray-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[u.headerText&&(0,s.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2 border-b pb-2",children:u.headerText}),(0,s.jsx)("div",{className:"text-gray-800 whitespace-pre-wrap",children:l.content}),u.footerText&&(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-2 pt-2 border-t",children:u.footerText})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,s.jsx)(D.z,{type:"button",onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 px-6 py-3",disabled:y,children:"Cancelar"}),(0,s.jsx)(D.z,{type:"submit",disabled:y,className:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white px-8 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:y?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{size:18,className:"mr-2 animate-spin"}),"Activando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{size:18,className:"mr-2"}),"Activar Plantilla"]})})]})]})]})})})}function V(e){let{isOpen:a,onClose:t,onSuccess:l,toast:o}=e,[i,c]=(0,r.useState)({name:"",content:"",category:"general",variables:"",isPublic:!1,language:"es",businessCategory:"UTILITY",headerText:"",footerText:"",twilioTemplateId:"",twilioContentSid:"",hasInteractiveButtons:!1,templateType:"TEXT",buttonsConfig:""}),[m,x]=(0,r.useState)([{type:"QUICK_REPLY",text:"Confirmar"},{type:"QUICK_REPLY",text:"Cancelar"}]),[u,g]=(0,r.useState)(!1),y=(e=>{let a;let t=/\{\{([^}]+)\}\}/g,s=[];for(;null!==(a=t.exec(e));){let e=a[1].trim();e&&s.push(e)}let r=[...new Set(s)];return{allVariables:s,uniqueVariables:r,hasDuplicates:s.length!==r.length}})(i.content),j=e=>{m.length>1&&x(m.filter((a,t)=>t!==e))},v=(e,a,t)=>{let s=[...m];s[e]={...s[e],[a]:t},x(s)},N=async e=>{e.preventDefault(),g(!0);try{let e=localStorage.getItem("token"),a=y.uniqueVariables;if(y.hasDuplicates){o.error("Variables duplicadas detectadas","Las variables ".concat(y.allVariables.join(", ")," contienen duplicados. Esto puede causar errores en Twilio."));return}let t=null;if(i.hasInteractiveButtons){let e=m.filter(e=>""!==e.text.trim());if(0===e.length){o.error("Error en configuraci\xf3n de botones","Debes agregar al menos un bot\xf3n");return}if(e.length>3){o.error("Error en configuraci\xf3n de botones","M\xe1ximo 3 botones permitidos");return}t=e}let s={...i,variables:a,buttonsConfig:t,status:"approved"},r=await fetch("".concat(n.T,"/api/admin/templates/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(s)}),d=await r.json();d.success?(o.success("Plantilla creada exitosamente","La plantilla est\xe1 lista para usar"),l(),c({name:"",content:"",category:"general",variables:"",isPublic:!1,language:"es",businessCategory:"UTILITY",headerText:"",footerText:"",twilioTemplateId:"",twilioContentSid:"",hasInteractiveButtons:!1,templateType:"TEXT",buttonsConfig:""}),x([{type:"QUICK_REPLY",text:"Confirmar"},{type:"QUICK_REPLY",text:"Cancelar"}])):o.error("Error creando plantilla",d.error||"No se pudo crear la plantilla")}catch(e){console.error("Error creating template:",e),o.error("Error de conexi\xf3n","No se pudo conectar con el servidor")}finally{g(!1)}};return a?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"Crear Nueva Plantilla"}),(0,s.jsx)(D.z,{onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 p-3 rounded-lg",children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(b.Z,{className:"w-5 h-5 mr-2 text-primary-600"}),"Informaci\xf3n B\xe1sica"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla *"}),(0,s.jsx)("input",{type:"text",required:!0,value:i.name,onChange:e=>c({...i,name:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"ej. Confirmaci\xf3n de Cita"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda"}),(0,s.jsxs)("select",{value:i.category,onChange:e=>c({...i,category:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"general",children:"General"}),(0,s.jsx)("option",{value:"appointment_update",children:"Actualizaci\xf3n de Citas"}),(0,s.jsx)("option",{value:"payment_reminder",children:"Recordatorio de Pago"}),(0,s.jsx)("option",{value:"service_notification",children:"Notificaci\xf3n de Servicio"}),(0,s.jsx)("option",{value:"marketing",children:"Marketing"}),(0,s.jsx)("option",{value:"support",children:"Soporte"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Variables Detectadas Autom\xe1ticamente"}),(0,s.jsx)("div",{className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg bg-gray-50",children:y.uniqueVariables.length>0?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:y.uniqueVariables.map((e,a)=>(0,s.jsx)("span",{className:"px-3 py-1 bg-primary-100 text-primary-800 rounded-full text-sm font-medium",children:"{{".concat(e,"}}")},a))}),y.hasDuplicates&&(0,s.jsxs)("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,s.jsxs)("p",{className:"text-sm text-yellow-800",children:["⚠️ ",(0,s.jsx)("strong",{children:"Advertencia:"})," Variables duplicadas detectadas. Esto puede causar error 63028 en Twilio."]}),(0,s.jsxs)("p",{className:"text-xs text-yellow-600 mt-1",children:["Variables encontradas: ",y.allVariables.join(", ")]})]})]}):(0,s.jsxs)("p",{className:"text-gray-500 text-sm italic",children:["Escribe tu mensaje abajo usando variables como ","{{nombre}}"," y aparecer\xe1n aqu\xed autom\xe1ticamente"]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Las variables se detectan autom\xe1ticamente del contenido del mensaje y se env\xedan a Twilio con estos nombres exactos."})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isPublic",checked:i.isPublic,onChange:e=>c({...i,isPublic:e.target.checked}),className:"mr-2"}),(0,s.jsx)("label",{htmlFor:"isPublic",className:"text-sm font-medium text-gray-700",children:"Plantilla P\xfablica (visible para todos los usuarios)"})]})]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 mr-2 text-green-600"}),"Configuraci\xf3n WhatsApp"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template ID de Twilio"}),(0,s.jsx)("input",{type:"text",value:i.twilioTemplateId,onChange:e=>c({...i,twilioTemplateId:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"HX..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content SID (opcional)"}),(0,s.jsx)("input",{type:"text",value:i.twilioContentSid,onChange:e=>c({...i,twilioContentSid:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"HX..."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Idioma"}),(0,s.jsxs)("select",{value:i.language,onChange:e=>c({...i,language:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,s.jsx)("option",{value:"en",children:"English"}),(0,s.jsx)("option",{value:"pt",children:"Portugu\xeas"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda Business"}),(0,s.jsxs)("select",{value:i.businessCategory,onChange:e=>c({...i,businessCategory:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"UTILITY",children:"Utilidad"}),(0,s.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,s.jsx)("option",{value:"AUTHENTICATION",children:"Autenticaci\xf3n"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Header Text (opcional)"}),(0,s.jsx)("input",{type:"text",value:i.headerText,onChange:e=>c({...i,headerText:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Texto del encabezado"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Footer Text (opcional)"}),(0,s.jsx)("input",{type:"text",value:i.footerText,onChange:e=>c({...i,footerText:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Texto del pie"})]})]})]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 mr-2 text-accent-600"}),"Contenido del Mensaje"]}),(0,s.jsx)("textarea",{required:!0,value:i.content,onChange:e=>c({...i,content:e.target.value}),rows:6,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Hola {{nombre}}, tu cita para {{servicio}} est\xe1 confirmada para el {{fecha}} a las {{hora}}. \xa1Te esperamos!"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Usa variables como ","{{nombre}}"," en tu mensaje. Las variables se detectar\xe1n autom\xe1ticamente y aparecer\xe1n arriba. Los nombres exactos se env\xedan a Twilio."]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(E.Z,{className:"w-5 h-5 mr-2 text-purple-600"}),"Botones Interactivos (Opcional)"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"hasButtons",checked:i.hasInteractiveButtons,onChange:e=>c({...i,hasInteractiveButtons:e.target.checked}),className:"mr-2"}),(0,s.jsx)("label",{htmlFor:"hasButtons",className:"text-sm font-medium text-gray-700",children:"Esta plantilla tiene botones interactivos"})]}),i.hasInteractiveButtons&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Plantilla"}),(0,s.jsxs)("select",{value:i.templateType,onChange:e=>c({...i,templateType:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"TEXT",children:"Texto"}),(0,s.jsx)("option",{value:"INTERACTIVE",children:"Interactiva"}),(0,s.jsx)("option",{value:"MEDIA",children:"Media"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Botones de Respuesta"}),(0,s.jsxs)(D.z,{type:"button",onClick:()=>{m.length<3&&x([...m,{type:"QUICK_REPLY",text:""}])},disabled:m.length>=3,className:"bg-green-100 hover:bg-green-200 text-green-700 px-3 py-1 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(A.Z,{size:14,className:"mr-1"}),"Agregar Bot\xf3n"]})]}),(0,s.jsx)("div",{className:"space-y-3",children:m.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tipo"}),(0,s.jsxs)("select",{value:e.type,onChange:e=>v(a,"type",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-primary-500",children:[(0,s.jsx)("option",{value:"QUICK_REPLY",children:"Respuesta R\xe1pida"}),(0,s.jsx)("option",{value:"URL",children:"URL"})]})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"URL"===e.type?"Texto del bot\xf3n":"Texto de respuesta"}),(0,s.jsx)("input",{type:"text",value:e.text,onChange:e=>v(a,"text",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-primary-500",placeholder:"URL"===e.type?"ej. Ver m\xe1s":"ej. Confirmar",maxLength:20}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.text.length,"/20 caracteres"]})]})]}),"URL"===e.type&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"URL de destino"}),(0,s.jsx)("input",{type:"url",value:e.url||"",onChange:e=>v(a,"url",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-primary-500",placeholder:"https://ejemplo.com"})]})]}),m.length>1&&(0,s.jsx)(D.z,{type:"button",onClick:()=>j(a),className:"bg-red-100 hover:bg-red-200 text-red-700 p-2 flex-shrink-0",children:(0,s.jsx)(S,{size:16})})]},a))}),(0,s.jsx)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:(0,s.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,s.jsx)("strong",{children:"\uD83D\uDCA1 Consejos:"}),(0,s.jsx)("br",{}),"• M\xe1ximo 3 botones por plantilla",(0,s.jsx)("br",{}),"• Textos cortos y claros (m\xe1x. 20 caracteres)",(0,s.jsx)("br",{}),"• Los botones de respuesta r\xe1pida env\xedan el texto como respuesta",(0,s.jsx)("br",{}),"• Los botones URL abren enlaces externos"]})})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,s.jsx)(D.z,{type:"button",onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 px-6 py-3",children:"Cancelar"}),(0,s.jsx)(D.z,{type:"submit",disabled:u,className:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white px-8 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{size:18,className:"mr-2 animate-spin"}),"Creando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{size:18,className:"mr-2"}),"Crear Plantilla"]})})]})]})]})})}):null}function Y(e){let{isOpen:a,onClose:t,template:l,onSuccess:o,toast:i}=e,[c,m]=(0,r.useState)({name:"",content:"",category:"general",variables:"",isPublic:!1,language:"es",businessCategory:"UTILITY",headerText:"",footerText:"",twilioTemplateId:"",twilioContentSid:"",hasInteractiveButtons:!1,templateType:"TEXT",status:"pending"}),[x,u]=(0,r.useState)([{type:"QUICK_REPLY",text:"Confirmar"},{type:"QUICK_REPLY",text:"Cancelar"}]),[p,g]=(0,r.useState)(!1),y=(e=>{let a;let t=/\{\{([^}]+)\}\}/g,s=[];for(;null!==(a=t.exec(e));){let e=a[1].trim();e&&s.push(e)}let r=[...new Set(s)];return{allVariables:s,uniqueVariables:r,hasDuplicates:s.length!==r.length}})(c.content);(0,r.useEffect)(()=>{if(l&&a){var e;if(m({name:l.name||"",content:l.content||"",category:l.category||"general",variables:(null===(e=l.variables)||void 0===e?void 0:e.join(", "))||"",isPublic:!1,language:l.language||"es",businessCategory:l.businessCategory||"UTILITY",headerText:l.headerText||"",footerText:l.footerText||"",twilioTemplateId:l.twilioTemplateId||"",twilioContentSid:l.twilioContentSid||"",hasInteractiveButtons:!1,templateType:"TEXT",status:l.status}),l.variablesMapping&&"object"==typeof l.variablesMapping){let e=l.variablesMapping.buttonsConfig;Array.isArray(e)&&e.length>0&&(u(e),m(e=>({...e,hasInteractiveButtons:!0,templateType:"INTERACTIVE"})))}}},[l,a]);let j=e=>{x.length>1&&u(x.filter((a,t)=>t!==e))},v=(e,a,t)=>{let s=[...x];s[e]={...s[e],[a]:t},u(s)},N=async e=>{if(e.preventDefault(),l){g(!0);try{let e=localStorage.getItem("token"),a=y.uniqueVariables;if(y.hasDuplicates){i.error("Variables duplicadas detectadas","Las variables ".concat(y.allVariables.join(", ")," contienen duplicados. Esto puede causar errores en Twilio."));return}let t=null;if(c.hasInteractiveButtons){let e=x.filter(e=>""!==e.text.trim());if(0===e.length){i.error("Error en configuraci\xf3n de botones","Debes agregar al menos un bot\xf3n");return}if(e.length>3){i.error("Error en configuraci\xf3n de botones","M\xe1ximo 3 botones permitidos");return}t=e}let s={...c,variables:a,buttonsConfig:t},r=await fetch("".concat(n.T,"/api/admin/templates/").concat(l.id),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(s)}),d=await r.json();d.success?(i.success("Plantilla actualizada exitosamente","Los cambios han sido guardados correctamente"),o()):i.error("Error actualizando plantilla",d.error||"No se pudo actualizar la plantilla")}catch(e){console.error("Error updating template:",e),i.error("Error de conexi\xf3n","No se pudo conectar con el servidor")}finally{g(!1)}}};return a&&l?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"Editar Plantilla"}),(0,s.jsxs)("p",{className:"text-gray-600 mt-2",children:['Modificando: "',l.name,'"']})]}),(0,s.jsx)(D.z,{onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 p-3 rounded-lg",disabled:p,children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(b.Z,{className:"w-5 h-5 mr-2 text-primary-600"}),"Informaci\xf3n B\xe1sica"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla *"}),(0,s.jsx)("input",{type:"text",required:!0,value:c.name,onChange:e=>m({...c,name:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"ej. Confirmaci\xf3n de Cita"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda"}),(0,s.jsxs)("select",{value:c.category,onChange:e=>m({...c,category:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"general",children:"General"}),(0,s.jsx)("option",{value:"appointment_update",children:"Actualizaci\xf3n de Citas"}),(0,s.jsx)("option",{value:"payment_reminder",children:"Recordatorio de Pago"}),(0,s.jsx)("option",{value:"service_notification",children:"Notificaci\xf3n de Servicio"}),(0,s.jsx)("option",{value:"marketing",children:"Marketing"}),(0,s.jsx)("option",{value:"support",children:"Soporte"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Variables Detectadas Autom\xe1ticamente"}),(0,s.jsx)("div",{className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg bg-gray-50",children:y.uniqueVariables.length>0?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:y.uniqueVariables.map((e,a)=>(0,s.jsx)("span",{className:"px-3 py-1 bg-primary-100 text-primary-800 rounded-full text-sm font-medium",children:"{{".concat(e,"}}")},a))}),y.hasDuplicates&&(0,s.jsxs)("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,s.jsxs)("p",{className:"text-sm text-yellow-800",children:["⚠️ ",(0,s.jsx)("strong",{children:"Advertencia:"})," Variables duplicadas detectadas. Esto puede causar error 63028 en Twilio."]}),(0,s.jsxs)("p",{className:"text-xs text-yellow-600 mt-1",children:["Variables encontradas: ",y.allVariables.join(", ")]})]})]}):(0,s.jsxs)("p",{className:"text-gray-500 text-sm italic",children:["Escribe tu mensaje abajo usando variables como ","{{nombre}}"," y aparecer\xe1n aqu\xed autom\xe1ticamente"]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Las variables se detectan autom\xe1ticamente del contenido del mensaje y se env\xedan a Twilio con estos nombres exactos."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),(0,s.jsxs)("select",{value:c.status,onChange:e=>m({...c,status:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"ai_pending",children:"\uD83E\uDD16 Validaci\xf3n IA"}),(0,s.jsx)("option",{value:"pending",children:"⏳ Pendiente Revisi\xf3n"}),(0,s.jsx)("option",{value:"approved",children:"✅ Aprobada"}),(0,s.jsx)("option",{value:"rejected",children:"❌ Rechazada"}),(0,s.jsx)("option",{value:"active",children:"\uD83D\uDE80 Activa"})]})]})]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 mr-2 text-green-600"}),"Configuraci\xf3n WhatsApp"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template ID de Twilio"}),(0,s.jsx)("input",{type:"text",value:c.twilioTemplateId,onChange:e=>m({...c,twilioTemplateId:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"HX..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content SID"}),(0,s.jsx)("input",{type:"text",value:c.twilioContentSid,onChange:e=>m({...c,twilioContentSid:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"HX..."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Idioma"}),(0,s.jsxs)("select",{value:c.language,onChange:e=>m({...c,language:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,s.jsx)("option",{value:"en",children:"English"}),(0,s.jsx)("option",{value:"pt",children:"Portugu\xeas"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda Business"}),(0,s.jsxs)("select",{value:c.businessCategory,onChange:e=>m({...c,businessCategory:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"UTILITY",children:"Utilidad"}),(0,s.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,s.jsx)("option",{value:"AUTHENTICATION",children:"Autenticaci\xf3n"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Header Text (opcional)"}),(0,s.jsx)("input",{type:"text",value:c.headerText,onChange:e=>m({...c,headerText:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Texto del encabezado"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Footer Text (opcional)"}),(0,s.jsx)("input",{type:"text",value:c.footerText,onChange:e=>m({...c,footerText:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Texto del pie"})]})]})]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 mr-2 text-accent-600"}),"Contenido del Mensaje"]}),(0,s.jsx)("textarea",{required:!0,value:c.content,onChange:e=>m({...c,content:e.target.value}),rows:6,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",placeholder:"Hola {{nombre}}, tu cita para {{servicio}} est\xe1 confirmada para el {{fecha}} a las {{hora}}. \xa1Te esperamos!"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Usa variables como ","{{nombre}}"," en tu mensaje. Las variables se detectar\xe1n autom\xe1ticamente y aparecer\xe1n arriba. Los nombres exactos se env\xedan a Twilio."]})]}),(0,s.jsxs)(L.Zb,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,s.jsx)(E.Z,{className:"w-5 h-5 mr-2 text-purple-600"}),"Botones Interactivos (Opcional)"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"hasButtons",checked:c.hasInteractiveButtons,onChange:e=>m({...c,hasInteractiveButtons:e.target.checked}),className:"mr-2"}),(0,s.jsx)("label",{htmlFor:"hasButtons",className:"text-sm font-medium text-gray-700",children:"Esta plantilla tiene botones interactivos"})]}),c.hasInteractiveButtons&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Plantilla"}),(0,s.jsxs)("select",{value:c.templateType,onChange:e=>m({...c,templateType:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary-500 transition-colors",children:[(0,s.jsx)("option",{value:"TEXT",children:"Texto"}),(0,s.jsx)("option",{value:"INTERACTIVE",children:"Interactiva"}),(0,s.jsx)("option",{value:"MEDIA",children:"Media"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Botones de Respuesta"}),(0,s.jsxs)(D.z,{type:"button",onClick:()=>{x.length<3&&u([...x,{type:"QUICK_REPLY",text:""}])},disabled:x.length>=3,className:"bg-green-100 hover:bg-green-200 text-green-700 px-3 py-1 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(A.Z,{size:14,className:"mr-1"}),"Agregar Bot\xf3n"]})]}),(0,s.jsx)("div",{className:"space-y-3",children:x.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tipo"}),(0,s.jsxs)("select",{value:e.type,onChange:e=>v(a,"type",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-primary-500",children:[(0,s.jsx)("option",{value:"QUICK_REPLY",children:"Respuesta R\xe1pida"}),(0,s.jsx)("option",{value:"URL",children:"URL"})]})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"URL"===e.type?"Texto del bot\xf3n":"Texto de respuesta"}),(0,s.jsx)("input",{type:"text",value:e.text,onChange:e=>v(a,"text",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-primary-500",placeholder:"URL"===e.type?"ej. Ver m\xe1s":"ej. Confirmar",maxLength:20}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.text.length,"/20 caracteres"]})]})]}),"URL"===e.type&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"URL de destino"}),(0,s.jsx)("input",{type:"url",value:e.url||"",onChange:e=>v(a,"url",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-primary-500",placeholder:"https://ejemplo.com"})]})]}),x.length>1&&(0,s.jsx)(D.z,{type:"button",onClick:()=>j(a),className:"bg-red-100 hover:bg-red-200 text-red-700 p-2 flex-shrink-0",children:(0,s.jsx)(S,{size:16})})]},a))}),(0,s.jsx)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:(0,s.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,s.jsx)("strong",{children:"\uD83D\uDCA1 Consejos:"}),(0,s.jsx)("br",{}),"• M\xe1ximo 3 botones por plantilla",(0,s.jsx)("br",{}),"• Textos cortos y claros (m\xe1x. 20 caracteres)",(0,s.jsx)("br",{}),"• Los botones de respuesta r\xe1pida env\xedan el texto como respuesta",(0,s.jsx)("br",{}),"• Los botones URL abren enlaces externos"]})})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,s.jsx)(D.z,{type:"button",onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 px-6 py-3",disabled:p,children:"Cancelar"}),(0,s.jsx)(D.z,{type:"submit",disabled:p,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-8 py-3 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{size:18,className:"mr-2 animate-spin"}),"Actualizando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z,{size:18,className:"mr-2"}),"Actualizar Plantilla"]})})]})]})]})})}):null}},43863:function(e,a,t){"use strict";t.d(a,{Y:function(){return n}});var s=t(57437),r=t(94508);let l={pulse:"animate-pulse-fast",spin:"animate-spin-slow",bounce:"animate-bounce-subtle",none:""};function n(e){let{icon:a,animation:t="none",className:n,size:o=24,...i}=e;return(0,s.jsx)(a,{size:o,className:(0,r.cn)("transition-all duration-300",l[t],n),...i})}},89534:function(e,a,t){"use strict";t.d(a,{ToastProvider:function(){return m},p:function(){return p}});var s=t(57437),r=t(2265),l=t(41671),n=t(99388),o=t(76865),i=t(33245),c=t(32489);let d=(0,r.createContext)(void 0);function m(e){let{children:a}=e,[t,l]=(0,r.useState)([]),n=(0,r.useCallback)(e=>{l(a=>a.filter(a=>a.id!==e))},[]),o=(0,r.useCallback)(e=>{let a=Math.random().toString(36).substring(2,15),t={...e,id:a};l(e=>[...e,t]),setTimeout(()=>{n(a)},e.duration||5e3)},[n]),i=(0,r.useCallback)((e,a)=>{o({type:"success",title:e,message:a})},[o]),c=(0,r.useCallback)((e,a)=>{o({type:"error",title:e,message:a,duration:7e3})},[o]),m=(0,r.useCallback)((e,a)=>{o({type:"warning",title:e,message:a})},[o]),u=(0,r.useCallback)((e,a)=>{o({type:"info",title:e,message:a})},[o]);return(0,s.jsxs)(d.Provider,{value:{toasts:t,addToast:o,removeToast:n,success:i,error:c,warning:m,info:u},children:[a,(0,s.jsx)(x,{})]})}function x(){let{toasts:e,removeToast:a}=p();return(0,s.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>(0,s.jsx)(u,{toast:e,onRemove:a},e.id))})}function u(e){let{toast:a,onRemove:t}=e;return(0,s.jsx)("div",{className:"\n      max-w-sm w-full bg-white rounded-lg shadow-lg border-l-4 p-4 animate-slide-in-right\n      ".concat((()=>{switch(a.type){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800"}})(),"\n    "),children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(()=>{switch(a.type){case"success":return(0,s.jsx)(l.Z,{className:"w-5 h-5 text-green-500"});case"error":return(0,s.jsx)(n.Z,{className:"w-5 h-5 text-red-500"});case"warning":return(0,s.jsx)(o.Z,{className:"w-5 h-5 text-yellow-500"});case"info":return(0,s.jsx)(i.Z,{className:"w-5 h-5 text-blue-500"})}})()}),(0,s.jsxs)("div",{className:"ml-3 flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:a.title}),a.message&&(0,s.jsx)("p",{className:"mt-1 text-sm opacity-90",children:a.message})]}),(0,s.jsx)("button",{onClick:()=>t(a.id),className:"ml-2 flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(c.Z,{className:"w-4 h-4"})})]})})}function p(){let e=(0,r.useContext)(d);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},31047:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},40875:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},22135:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},91723:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},48736:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},33245:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},53417:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},33276:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},82431:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},73247:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},88906:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},92369:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},32489:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},11239:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])}},function(e){e.O(0,[14,126,971,117,744],function(){return e(e.s=64070)}),_N_E=e.O()}]);